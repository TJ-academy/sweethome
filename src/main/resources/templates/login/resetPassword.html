<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>비밀번호 재설정</title>

<script>
function resetPassword() {
	const password = document.getElementById("password").value;
	const confirmPassword = document.getElementById("confirmPassword").value;
	
	if (password !== confirmPassword) {
		document.getElementById("result").innerText ="비밀번호가 일치하지 않습니다.";
		return;
	}
	
	fetch("/user/resetPassword", {
		method: "POST",
		headers: {
			"Content-Type": "application/json"
		},
		body: JSON.stringify({
			password: password
		})
	})
	.then(res => res.text())
	.then(msg => {
		document.getElementById("result").innerText =msg;
		if (msg === "비밀번호가 성공적으로 변경되었습니다.") {
			window.location.href = "/user/login";
		}
	});
}
</script>

<link rel="stylesheet" th:href="@{/css/fragments/fragments.css}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>
<body>
<div th:insert="fragments/header :: menuBar"></div>
<h1>비밀번호 재설정</h1>

<form action="/user/resetPassword" method="post">
	<input type="hidden" name="email" th:value="${email}">
	
	<label for="password">새 비밀번호:</label>
	<input type="password" id="password" name="password" required><br><br>
	
	<label for="password">비밀번호 확인:</label>
	<input type="password" id="confirmPassword" name="confirmPassword" required><br><br>
	
	<button type="submit">비밀번호 재설정</button>
</form>

<p th:text="${error}" style="color: red;"></p>
<p th:text="${success}" style="color: black;"></p>

<a href="/">홈으로</a>

</body>
</html>